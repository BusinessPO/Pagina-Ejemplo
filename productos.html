<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Producto | Tiendatech</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cooper+Black&display=swap');
    * { box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      background: url('admin/img/textura.jpg') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      color: #222;
    }
    nav {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      gap: 20px;
      padding: 12px;
      z-index: 1000;
      flex-wrap: wrap;
      align-items: center;
    }
    nav button, nav select {
      background: transparent;
      border: none;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      padding: 6px 12px;
      border-radius: 6px;
      transition: background-color 0.3s;
      font-weight: bold;
    }
    nav button:hover, nav select:hover {
      background: rgba(255,255,255,0.2);
    }
    #user-btn {
      background: #28a745;
      color: white;
    }
    #user-btn:hover {
      background: #218838;
    }
    .contenedor-producto {
      max-width: 1100px;
      margin: 100px auto 40px;
      background: white;
      padding: 24px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      display: flex;
      gap: 30px;
      align-items: flex-start;
      flex-wrap: wrap;
    }
    .producto-img {
      flex: 1 1 45%;
    }
    .producto-img img {
      width: 100%;
      border-radius: 10px;
    }
    .producto-detalles {
      flex: 1 1 50%;
    }
    .producto-detalles h1 {
      font-family: 'Cooper Black', cursive;
      font-size: 2rem;
      margin: 0 0 10px;
    }
    .producto-detalles p {
      font-size: 1rem;
      line-height: 1.5;
    }
    .precio {
      font-size: 1.3rem;
      font-weight: bold;
      margin: 20px 0;
    }
    .precio .tachado {
      color: #888;
      text-decoration: line-through;
      margin-right: 10px;
      font-weight: normal;
    }
    button {
      background: #28a745;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background: #218838;
    }
    .estrellas {
      font-size: 1.5rem;
      color: gold;
      margin: 10px 0;
    }
    details {
      margin-top: 15px;
    }
    textarea {
      width: 100%;
      min-height: 100px;
      margin-top: 20px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <nav>
    <button onclick="ir('index.html')" id="btn-inicio">Inicio</button>
    <button onclick="ir('masvendido.html')" id="btn-masvendido">Lo más vendido</button>
    <button onclick="ir('ofertas.html')" id="btn-ofertas">Ofertas</button>
    <button onclick="ir('nuevo.html')" id="btn-nuevo">Lo nuevo</button>
    <button onclick="ir('contacto.html')" id="btn-contacto">Contáctanos</button>
    <button onclick="ir('nosotros.html')" id="btn-nosotros">Sobre nosotros</button>
    <select id="idioma" onchange="cambiarIdioma(this.value)">
      <option value="es">ES</option>
      <option value="en">EN</option>
    </select>
  </nav>

  <div class="contenedor-producto">
    <div class="producto-img">
      <img id="producto-img" src="" alt="Producto" />
    </div>
    <div class="producto-detalles">
      <h1 id="producto-nombre"></h1>
      <div class="estrellas">
        ★★★★☆
      </div>
      <p id="producto-desc"></p>
      <div class="precio" id="producto-precio"></div>
      <details>
        <summary>Características</summary>
        <ul>
          <li>Característica 1</li>
          <li>Característica 2</li>
          <li>Característica 3</li>
        </ul>
      </details>
      <button id="agregar-btn">Agregar al carrito</button>
      <textarea placeholder="Escribe un comentario..."></textarea>
    </div>
  </div>
  
 <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="firebase.js"></script>
<script>
  const textos = {
    es: {
      agregar: "Agregar al carrito",
      productoAgregado: "Producto agregado al carrito",
      caracteristicas: "Características",
      placeholder: "Escribe un comentario..."
    },
    en: {
      agregar: "Add to cart",
      productoAgregado: "Product added to cart",
      caracteristicas: "Features",
      placeholder: "Write a comment..."
    }
  };

  let idioma = localStorage.getItem("idioma") || "es";
  document.getElementById("idioma").value = idioma;

  function cambiarIdioma(val) {
    idioma = val;
    localStorage.setItem("idioma", idioma);
    location.reload();
  }

  function ir(ruta) {
    location.href = ruta;
  }

  const params = new URLSearchParams(location.search);
  const id = params.get("id");

  async function cargarProducto() {
    try {
      const doc = await db.collection("productos").doc(id).get();
      if (!doc.exists) {
        document.body.innerHTML = "<h2>Producto no encontrado.</h2>";
        return;
      }

      const p = doc.data();

      document.getElementById("producto-img").src = p.imagen;
      document.getElementById("producto-nombre").textContent = p.nombre;
      document.getElementById("producto-desc").textContent = p.descripcion;
      document.querySelector("details summary").textContent = textos[idioma].caracteristicas;
      document.querySelector("textarea").placeholder = textos[idioma].placeholder;
      document.getElementById("producto-precio").innerHTML = `$${p.precio}`;

      const agregarBtn = document.getElementById("agregar-btn");
      agregarBtn.textContent = textos[idioma].agregar;
      agregarBtn.onclick = () => {
        let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
        const item = carrito.find(i => i.id === id);
        if (item) item.cantidad++;
        else carrito.push({ id, cantidad: 1 });

        localStorage.setItem("carrito", JSON.stringify(carrito));
        alert(textos[idioma].productoAgregado);
      };

    } catch (err) {
      console.error("Error al cargar producto:", err);
    }
  }

  cargarProducto();
</script>
